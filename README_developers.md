# Instructions for developers
See [wiki](https://github.com/vijayvarma392/gw_eccentricity/wiki).

## Contributing to gw_eccentricity

The preferred method of making contributions is to
[fork](https://help.github.com/articles/fork-a-repo/) + [pull
request](https://help.github.com/articles/about-pull-requests/) from the main
[repo](https://github.com/vijayvarma392/gw_eccentricity).

Before doing a pull request, you should check that your changes don't break
anything by running the following from the root directory of your check-out.
Every pull request will be automatically tested by github.
```
./run_tests
```

## Adding a new eccentricity definition
For adding a new definition of eccentricity follow the guidelines [here](https://github.com/vijayvarma392/gw_eccentricity/wiki/Adding-new-eccentricity-definitions)

## Waveform data
Follow the instructions in `data/README.md`

## PyPI release
Note: Currently, only Vijay and Arif can do this, as they are the only ones with maintainer access to the PyPI package.
1. Update the version number at the top of gw_eccentricity/gw_eccentricity.py and commit all changes. This version number gets propagated to setup.py.
2. Do the following to release the new version:
```shell
python -m build
twine upload dist/*
```
## Create Conda recipe
**NOTE:** This is needed to be done only once to add the recipe to conda-forge/staged-recipe.
To update the conda release follow conda release section below.
1. Generate `conda` recipe using `grayskull` since we already have the PyPI package.
```shell
conda install -c conda-forge grayskull
grayskull pypi gw_eccentricity
```
2. Clone https://github.com/md-arif-shaikh/staged-recipes, a fork of
   https://github.com/conda-forge/staged-recipes.
3. Move the `meta.yaml` file generated by `grayskull` to `gw_eccentricity`
   directory under `recipe`.
4. Fix the `python` version under requirements, e.g., `python >=3.6`
5. Update recipe-maintainers.

## Conda release
To release a new conda version follow the instructions [here](
https://github.com/conda-forge/gw_eccentricity-feedstock#updating-gw_eccentricity-feedstock):

After each PyPI release, update the conda package to the same version by following the steps below:
1. Fork the feedstock repository https://github.com/conda-forge/gw_eccentricity-feedstock
2. Create a branch
3. Update `meta.yaml` under `recipe` at
 https://github.com/conda-forge/gw_eccentricity-feedstock/blob/main/recipe/meta.yaml<br>
 by changing the
 - version to the latest PyPI version.
 - sha256 hash number corresponding to the tar.gz file of this version. This can be found by clicking the `Download files` button in `gw_eccentricity` page on PyPi.
4. Commit the changes and make a PR.
